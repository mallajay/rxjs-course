# ðŸŽ¯ Advanced RxJS Operators in Angular: `switchMap` and `concat`

---

## ðŸ”„ `switchMap`: Switching Inner Observables with Cancellation

### ðŸ“˜ In Code

```ts
switchMap((search) => this.loadLessons(search));
```

### âœ… What It Does

- Transforms each **search input** into an HTTP request observable.
- If a **new input comes** before the previous request completes, **it cancels** the ongoing request.
- Ideal for **live search** to avoid outdated or overlapping backend calls.

---

### ðŸ’¡ Real-World Example

> Imagine you're typing in a search box quickly: `"h" â†’ "he" â†’ "hel" â†’ "hell" â†’ "hello"`
> Instead of sending 5 backend calls, only the **last request for "hello"** is processed.

---

### ðŸŽ“ Another Example (Custom)

```ts
fromEvent(inputEl, "input").pipe(
  debounceTime(300),
  distinctUntilChanged(),
  switchMap((query) => this.http.get(`/api/products?search=${query}`))
);
```

### ðŸ’¥ Why Not `concatMap` or `mergeMap`?

| Operator       | Behavior                         | Issue in Live Search    |
| -------------- | -------------------------------- | ----------------------- |
| `concatMap`    | Queues all requests sequentially | Slow & outdated results |
| `mergeMap`     | Runs all requests concurrently   | Backend overload        |
| âœ… `switchMap` | Cancels outdated requests        | âœ” Best for typeahead UX |

---

## âž• `concat`: Sequential Combination of Observables

### ðŸ“˜ In Your Code

```ts
this.lessons$ = concat(initLessons$, searchLesson$);
```

### âœ… What It Does

- Emits the result of `initLessons$` **first** (on page load)
- Once completed, it **starts** listening to `searchLesson$`
- Useful to show **initial data first**, then allow interaction.

---

## ðŸ§­ Operator Flow Overview

```text
User Types â†’ fromEvent â†’ map â†’ debounceTime(400ms) â†’ distinctUntilChanged
                                                               â†“
                                                  switchMap(loadLessons)
                                                               â†“
                                                  Lessons Observable
```

On Init:

```text
Component Init â†’ loadLessons()
                   â†“
        concat(initLessons$, searchLesson$) â†’ lessons$
```

---

## ðŸ“Š Marble Diagram (Described Visually)

### switchMap (Visualization)

![Marble Diagram for debounceTime + switchMap](./image/switchMap.png)

- Each input (a, b, c) triggers a new inner observable.
- When `c` arrives, `b` is canceled.
- Only latest value is processed.

---

### concat (Visualization)

```text
initLessons$:    ----A----
searchLesson$:         -----B----C----
                            â†“     â†“
concat output:     ----A--------B----C----
```

- `initLessons$` emits and completes.
- Then `searchLesson$` begins.

---

## âœ… Benefits of This Approach

| Feature                       | Technique / Operator         | Why It Matters                           |
| ----------------------------- | ---------------------------- | ---------------------------------------- |
| Initial data load             | `loadLessons()` + `concat`   | Page loads with default unfiltered data  |
| Live search optimization      | `debounceTime` + `switchMap` | Limits backend hits; reduces noise       |
| Prevent duplicate queries     | `distinctUntilChanged()`     | Avoids multiple HTTP calls for same term |
| Cancels outdated searches     | `switchMap()`                | Frees up backend, saves network load     |
| Composable and readable logic | `pipe(...)` with RxJS        | Clean code with declarative operators    |

---

## ðŸ§  Summary

By combining `switchMap`, `concat`, and supportive operators like `debounceTime`, `map`, and `distinctUntilChanged`, you build a **powerful, clean, and reactive** Angular application that:

- Loads data smartly on init
- Responds instantly but efficiently to user input
- Avoids unnecessary or stale backend calls

---
